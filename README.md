Docker Image with BAGEL
-----------------------

First we have to build the docker image. In this step the required libraries are
installed on top of the ubuntu:latest base image and the latest version of BAGEL is
pulled from github and is compiled:

~~~bash
docker build --tag quack-quack/bagel:latest .
~~~

To test the image we compute the Hartree-Fock energy of fluoric acid.
Since the entrypoint is BAGEL, the command below is equivalent to running
`BAGEL hf_svp_hf.json`, which writes the output to stdout:

~~~bash
docker run -w /tests --rm -i -t quack-quack/bagel:latest   hf_svp_hf.json
~~~

To log into the container and inspect it from the inside interactively,
the default entry point has to be replaced by a bash shell:

~~~bash
docker run --entrypoint /bin/bash --rm -it quack-quack/bagel:latest
~~~


Example
-------
The following steps run a CASSCF/svp calculation on the water molecule.


1) Create a container named `bagel-engine` with required resources.

~~~bash
docker container create \
    --name bagel-engine \
    --mount type=tmpfs,destination=/scratch \
    --cpus 2 --memory 6Gb \
      quack-quack/bagel:latest
~~~

2) Copy the input script describing the calculation to the container.

~~~bash
docker container cp  \
     h2o_svp_cas.json bagel-engine:/input.json
~~~

3) Perform the calculation, the container does the heavy lifting.
  The output generated by BAGEL is written to stdout.

~~~bash
docker container start \
     -a bagel-engine
~~~

4) The CASSCF orbitals were written to the file '/orbitals.molden'.
  If we are interested in this file, we have to copy it back before
  deleting the container.

~~~bash
docker container cp \
     bagel-engine:/orbitals.molden  /tmp/orbitals.molden
~~~

5) Finally the container is destroyed and all resources are relased.

~~~bash
docker container rm bagel-engine
~~~
